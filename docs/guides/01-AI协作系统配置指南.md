# AI 协作系统配置指南

> 通用 Monorepo AI 协作文档系统 - 适用于任何技术栈的项目初始化与协作配置

**文档性质**: 通用参考指南（可复用于任何新项目）
**版本**: v2.0
**适用场景**: 需要与 AI（Claude Code）长期协作的 Monorepo 项目

---

## 目录

1. [系统概述](#1-系统概述)
2. [核心设计理念](#2-核心设计理念)
3. [技术栈配置表](#3-技术栈配置表)
4. [文档架构设计（4 层）](#4-文档架构设计4-层)
5. [文档模板](#5-文档模板)
6. [初始化协议](#6-初始化协议)
7. [Slash Commands 概述](#7-slash-commands-概述)
8. [Git 工作流](#8-git-工作流)
9. [最佳实践](#9-最佳实践)
10. [FAQ](#10-faq)

---

## 1. 系统概述

### 1.1 解决的问题

在与 AI（Claude Code）长期协作开发项目时，常见问题：

| 问题 | 影响 | 本系统解决方案 |
|------|------|----------------|
| AI 记忆丢失 | 每次新会话需重复解释项目背景 | `CONTEXT.md` + `/start` 命令 |
| 文档混乱 | AI 文档与开发者文档混杂，检索困难 | 4 层文档架构分离 |
| 进度跟踪困难 | 不知道上次做到哪里 | `CURRENT.md` 滚动日志 |
| 工作流低效 | 手动更新文档，容易遗漏 | Slash Commands 自动化 |
| Token 膨胀 | 文档越来越大，AI 上下文成本高 | 归档机制 + 定期优化 |

### 1.2 系统价值

| 指标 | 优化前 | 优化后 | 提升 |
|------|--------|--------|------|
| AI 上下文恢复时间 | ~2 分钟 | ~30 秒 | 75% |
| 每日会话结束时间 | ~10 分钟 | ~2 分钟 | 80% |
| AI Token 消耗 | ~5000 tokens/会话 | ~3000 tokens/会话 | 40% |

### 1.3 适用场景

- ✅ 需要与 AI 长期协作的项目（6 个月以上）
- ✅ Monorepo 多应用/多包项目
- ✅ 前后端分离项目
- ✅ 个人项目或小团队项目（2-5 人）

---

## 2. 核心设计理念

### 2.1 分离关注点（Separation of Concerns）

```
AI 文档（ai-context/）     ←→     开发者文档（development/, architecture/, project/）
     ↓                                    ↓
为 AI 恢复记忆设计                  为人类阅读设计
追求简洁高效（~3000 tokens）        追求详细完整
```

### 2.2 渐进式信息披露（Progressive Disclosure）

```
/start           →  只读取 CONTEXT.md + CURRENT.md（快速启动）
/start --bug     →  额外读取 troubleshooting.md（场景启动）
/start --full    →  读取所有核心文档（完整启动）
```

### 2.3 自动化优先（Automation First）

- **Slash Commands**：将重复操作封装为命令
- **时间工具调用**：自动获取准确时间，避免计算错误
- **智能 commit**：检测现有 commit，避免重复提交

### 2.4 轻量化设计（Lightweight）

- **定期优化**（`/weekly`）：删除冗余内容
- **归档机制**（`/monthly`）：历史内容归档
- **Token 控制**：CONTEXT.md < 3000 tokens，CURRENT.md < 2500 tokens

---

## 3. 技术栈配置表

> Claude Code 根据用户描述的技术栈，使用此表替换模板中的变量

### 3.1 包管理器

| 变量 | npm | yarn | pnpm | bun |
|------|-----|------|------|-----|
| `${PM}` | npm | yarn | pnpm | bun |
| `${PM_INSTALL}` | npm install | yarn | pnpm install | bun install |
| `${PM_ADD}` | npm install | yarn add | pnpm add | bun add |
| `${PM_RUN}` | npm run | yarn | pnpm | bun run |
| `${PM_EXEC}` | npx | yarn | pnpm exec | bunx |
| `${LOCK_FILE}` | package-lock.json | yarn.lock | pnpm-lock.yaml | bun.lockb |

### 3.2 前端框架

| 变量 | React + Vite | Vue + Vite | Next.js | Nuxt |
|------|--------------|------------|---------|------|
| `${FE_FRAMEWORK}` | React | Vue | Next.js | Nuxt |
| `${FE_LANG}` | JavaScript/TypeScript | JavaScript/TypeScript | TypeScript | TypeScript |
| `${FE_BUILD_TOOL}` | Vite | Vite | Next.js Built-in | Nuxt Built-in |
| `${FE_DEV_CMD}` | `${PM_RUN} dev` | `${PM_RUN} dev` | `${PM_RUN} dev` | `${PM_RUN} dev` |
| `${FE_BUILD_CMD}` | `${PM_RUN} build` | `${PM_RUN} build` | `${PM_RUN} build` | `${PM_RUN} build` |
| `${FE_LINT_CMD}` | `${PM_RUN} lint` | `${PM_RUN} lint` | `${PM_RUN} lint` | `${PM_RUN} lint` |
| `${FE_COMPONENT_EXT}` | .jsx / .tsx | .vue | .tsx | .vue |
| `${FE_DIST_DIR}` | dist | dist | .next | .nuxt |

### 3.3 后端框架

| 变量 | Spring Boot | FastAPI | Express | NestJS |
|------|-------------|---------|---------|--------|
| `${BE_FRAMEWORK}` | Spring Boot | FastAPI | Express | NestJS |
| `${BE_LANG}` | Java | Python | JavaScript/TypeScript | TypeScript |
| `${BE_PM}` | Maven/Gradle | pip/poetry | npm/pnpm | npm/pnpm |
| `${BE_DEV_CMD}` | `./mvnw spring-boot:run` | `uvicorn main:app --reload` | `${PM_RUN} dev` | `${PM_RUN} start:dev` |
| `${BE_BUILD_CMD}` | `./mvnw package` | N/A | `${PM_RUN} build` | `${PM_RUN} build` |
| `${BE_TEST_CMD}` | `./mvnw test` | `pytest` | `${PM_RUN} test` | `${PM_RUN} test` |
| `${BE_ENTRY_FILE}` | Application.java | main.py | index.js / app.ts | main.ts |

### 3.4 数据库

| 变量 | MySQL | PostgreSQL | MongoDB | SQLite |
|------|-------|------------|---------|--------|
| `${DB_TYPE}` | MySQL | PostgreSQL | MongoDB | SQLite |
| `${DB_PORT}` | 3306 | 5432 | 27017 | N/A |
| `${DB_DRIVER}` | mysql-connector | psycopg2 / pg | mongoose / mongodb | sqlite3 |
| `${DB_ORM}` | JPA / MyBatis | SQLAlchemy / Prisma | Mongoose / Prisma | Prisma / Drizzle |

### 3.5 常用命令映射

```bash
# 通用命令模板（Claude Code 根据技术栈替换）

# 安装依赖
cd apps/frontend && ${PM_INSTALL}
cd apps/backend && ${BE_PM} install  # 或 pip install -r requirements.txt

# 启动开发服务器
cd apps/frontend && ${FE_DEV_CMD}
cd apps/backend && ${BE_DEV_CMD}

# 代码检查
cd apps/frontend && ${FE_LINT_CMD}

# 构建
cd apps/frontend && ${FE_BUILD_CMD}
cd apps/backend && ${BE_BUILD_CMD}

# 测试
cd apps/frontend && ${PM_RUN} test
cd apps/backend && ${BE_TEST_CMD}

# 依赖检查
cd apps/frontend && ${PM_EXEC} depcheck
cd apps/frontend && ${PM} outdated
```

---

## 4. 文档架构设计（4 层）

### 4.1 目录结构

```
project-root/
├── .claude/
│   └── commands/           # Slash Commands 配置
│       ├── start.md
│       ├── checkpoint.md
│       ├── end.md
│       ├── weekly.md
│       ├── monthly.md
│       └── audit.md
│
├── docs/
│   ├── ai-context/         # 第 1 层：AI 记忆层 ⭐
│   │   ├── CONTEXT.md      # 项目快照（AI 上下文中枢）
│   │   ├── CURRENT.md      # 滚动开发日志
│   │   └── archive/        # 历史归档
│   │
│   ├── development/        # 第 2 层：开发文档层
│   │   ├── frontend/
│   │   │   ├── components.md
│   │   │   ├── pages.md
│   │   │   └── troubleshooting.md
│   │   ├── backend/
│   │   │   ├── api.md
│   │   │   ├── database.md
│   │   │   └── troubleshooting.md
│   │   ├── DEVELOPMENT.md
│   │   └── SLASH_COMMANDS.md
│   │
│   ├── architecture/       # 第 3 层：架构层
│   │   ├── OVERVIEW.md
│   │   ├── tech-stack.md
│   │   └── adr/
│   │       ├── README.md
│   │       └── template.md
│   │
│   └── project/            # 第 4 层：项目层
│       ├── vision.md
│       ├── design.md
│       ├── ROADMAP.md
│       └── DEPLOYMENT.md
│
├── apps/
│   ├── frontend/           # 前端应用
│   └── backend/            # 后端应用
│
├── packages/               # 共享包（可选）
│   └── shared/
│
└── README.md
```

### 4.2 各层说明

| 层级 | 目录 | 目标读者 | 核心文件 | Token 预算 |
|------|------|----------|----------|------------|
| 第 1 层 | `ai-context/` | AI | CONTEXT.md, CURRENT.md | < 5500 |
| 第 2 层 | `development/` | 开发者 | components.md, api.md | 无限制 |
| 第 3 层 | `architecture/` | 架构师 | OVERVIEW.md, ADR | 无限制 |
| 第 4 层 | `project/` | 产品/业务 | vision.md, design.md | 无限制 |

---

## 5. 文档模板

### 5.1 CONTEXT.md 模板（AI 记忆中枢）

```markdown
# 项目上下文（AI 快速恢复）

> AI 协作记忆文件 - 快速恢复项目上下文，立即开始工作

**最后更新**: ${CURRENT_DATE} ${CURRENT_TIME}
**项目阶段**: ${PROJECT_PHASE}
**当前状态**: ${PROJECT_STATUS}

---

## TL;DR（30秒速览）

**项目名称**: ${PROJECT_NAME}
**项目性质**: ${PROJECT_TYPE}
**技术栈**: ${FE_FRAMEWORK} + ${BE_FRAMEWORK} + ${DB_TYPE}
**核心特点**:
- ${FEATURE_1}
- ${FEATURE_2}
- ${FEATURE_3}

**开发进度**: ${PROGRESS_SUMMARY}
**下一步**: ${NEXT_TASK}

---

## 项目本质

这是一个 **${PROJECT_TYPE}**，主要功能：

- ${MAIN_FUNCTION_1}
- ${MAIN_FUNCTION_2}
- ${MAIN_FUNCTION_3}

**设计理念**:
- ${DESIGN_PRINCIPLE_1}
- ${DESIGN_PRINCIPLE_2}

---

## 当前开发状态

### ✅ 已完成

- ${COMPLETED_1}
- ${COMPLETED_2}

### 🚧 进行中

- ${IN_PROGRESS_1}

### 📋 待开始

- ${TODO_1}
- ${TODO_2}

---

## 技术栈

### 前端
- **框架**: ${FE_FRAMEWORK} ${FE_VERSION}
- **语言**: ${FE_LANG}
- **构建工具**: ${FE_BUILD_TOOL}
- **包管理**: ${PM}

### 后端
- **框架**: ${BE_FRAMEWORK} ${BE_VERSION}
- **语言**: ${BE_LANG}
- **数据库**: ${DB_TYPE}

### 开发工具
- **代码检查**: ESLint / Prettier
- **版本控制**: Git
- **部署**: ${DEPLOY_PLATFORM}

---

## 下一步任务

### 当前焦点
${CURRENT_FOCUS}

### 优先级 1（本周）
1. ${P1_TASK_1}
2. ${P1_TASK_2}

### 优先级 2（下周）
1. ${P2_TASK_1}
2. ${P2_TASK_2}

---

## 协作偏好（重要！必读）

### 开发节奏
- ✅ **每次只执行一步** - 不要一次性做太多改动
- ✅ **说明原因和目的** - 每一步都要解释为什么
- ✅ **等待确认** - 完成一步后等待用户确认

### 设计风格
- ✅ ${STYLE_PREFERENCE_1}
- ✅ ${STYLE_PREFERENCE_2}
- ❌ ${STYLE_AVOID}

### Git 提交规范
```
<type>(<scope>): <subject>

type: feat | fix | docs | refactor | perf | test | chore
```

---

## 快速导航

- [当前进度](CURRENT.md) ⭐
- [开发规范](../development/DEVELOPMENT.md)
- [架构总览](../architecture/OVERVIEW.md)
- [ADR 索引](../architecture/adr/README.md)
- [项目愿景](../project/vision.md) ⭐

---

## 快速恢复上下文

```bash
/start              # 快速启动（默认）
/start --full       # 完整启动（首次使用）
/start --bug        # Bug 修复模式
/start --api        # API 开发模式
```

---

**Token 效率**: ~2800 tokens
**更新频率**: 每周或重大变更时
```

### 5.2 CURRENT.md 模板（滚动日志）

```markdown
# 当前开发进度（滚动日志）

> 本周/本月开发进度记录 - AI 了解最近完成了什么

**本周时间**: ${WEEK_START} - ${WEEK_END}（第 ${WEEK_NUM} 周）
**最后更新**: ${CURRENT_DATE} ${CURRENT_TIME}
**当前阶段**: ${PROJECT_PHASE}

---

## 本周概览

**Week ${WEEK_NUM}**: ${WEEK_START} - ${WEEK_END}

**本周目标**：
- ${WEEK_GOAL_1}
- ${WEEK_GOAL_2}

**本周完成**：
- ✅ ${WEEK_DONE_1}
- ✅ ${WEEK_DONE_2}

**工作时长**: ${WORK_HOURS}h
**Commits**: ${COMMIT_COUNT} 次

---

## Day-by-Day 开发日志

### Day 1 - ${DAY_1_DATE}（${DAY_1_NAME}）⭐ ${DAY_1_TITLE}

**工作时长**: ${DAY_1_HOURS}h
**核心任务**: ${DAY_1_TASK}

**完成工作**：
- ✅ ${DAY_1_WORK_1}
- ✅ ${DAY_1_WORK_2}

**技术亮点**：
- ${DAY_1_HIGHLIGHT}

**遇到的问题**：
- **问题**: ${DAY_1_PROBLEM}
- **解决方案**: ${DAY_1_SOLUTION}

---

## 本周任务

### P0（Critical）
- [ ] ${P0_TASK_1}
- [ ] ${P0_TASK_2}

### P1（High）
- [ ] ${P1_TASK_1}

### P2（Medium）
- [ ] ${P2_TASK_1}

---

## 技术亮点

1. **${HIGHLIGHT_1_TITLE}**
   - ${HIGHLIGHT_1_DESC}

---

## 遇到的问题与解决方案

### 问题 1: ${PROBLEM_1_TITLE}
- **现象**: ${PROBLEM_1_SYMPTOM}
- **原因**: ${PROBLEM_1_CAUSE}
- **解决方案**: ${PROBLEM_1_SOLUTION}

---

## 下周计划

### 优先级 1
1. ${NEXT_WEEK_P1_1}
2. ${NEXT_WEEK_P1_2}

---

**更新频率**: 每次 `/checkpoint` 或 `/end` 自动更新
**归档机制**: 每月归档到 `archive/YYYY-MM.md`
```

### 5.3 后端 API 文档模板（api.md）

```markdown
# API 文档

> 后端 API 接口快速参考

**框架**: ${BE_FRAMEWORK}
**Base URL**: ${API_BASE_URL}
**最后更新**: ${CURRENT_DATE}

---

## API 概览

| 模块 | 端点数 | 描述 |
|------|--------|------|
| 用户 | ${USER_API_COUNT} | 用户认证、信息管理 |
| ${MODULE_2} | ${MODULE_2_COUNT} | ${MODULE_2_DESC} |

---

## 认证

### 认证方式
- **类型**: ${AUTH_TYPE}（JWT / Session / OAuth）
- **Header**: `Authorization: Bearer <token>`

---

## 用户模块

### POST /api/auth/login
**描述**: 用户登录

**请求体**:
```json
{
  "email": "string",
  "password": "string"
}
```

**响应**:
```json
{
  "token": "string",
  "user": {
    "id": "number",
    "email": "string",
    "name": "string"
  }
}
```

**状态码**:
| 状态码 | 描述 |
|--------|------|
| 200 | 登录成功 |
| 401 | 认证失败 |

---

## ${MODULE_2}

### ${METHOD} ${ENDPOINT}
**描述**: ${ENDPOINT_DESC}

**请求参数**:
| 参数 | 类型 | 必填 | 描述 |
|------|------|------|------|
| ${PARAM_NAME} | ${PARAM_TYPE} | ${REQUIRED} | ${PARAM_DESC} |

---

## 错误处理

### 通用错误格式
```json
{
  "error": {
    "code": "string",
    "message": "string"
  }
}
```

### 错误码
| 错误码 | HTTP 状态 | 描述 |
|--------|-----------|------|
| AUTH_FAILED | 401 | 认证失败 |
| NOT_FOUND | 404 | 资源不存在 |
| VALIDATION_ERROR | 400 | 参数校验失败 |
```

### 5.4 数据库文档模板（database.md）

```markdown
# 数据库设计文档

> 数据库 Schema 与设计说明

**数据库**: ${DB_TYPE}
**ORM**: ${DB_ORM}
**最后更新**: ${CURRENT_DATE}

---

## 数据库概览

| 表名 | 描述 | 记录数（估算） |
|------|------|----------------|
| users | 用户表 | ~${USER_COUNT} |
| ${TABLE_2} | ${TABLE_2_DESC} | ~${TABLE_2_COUNT} |

---

## ER 图

```
[users] 1 ──── N [posts]
   │
   └── 1 ──── 1 [profiles]
```

---

## 表结构

### users（用户表）

| 字段 | 类型 | 约束 | 描述 |
|------|------|------|------|
| id | INT / BIGINT | PK, AUTO_INCREMENT | 主键 |
| email | VARCHAR(255) | UNIQUE, NOT NULL | 邮箱 |
| password_hash | VARCHAR(255) | NOT NULL | 密码哈希 |
| name | VARCHAR(100) | NOT NULL | 用户名 |
| created_at | TIMESTAMP | DEFAULT NOW() | 创建时间 |
| updated_at | TIMESTAMP | ON UPDATE NOW() | 更新时间 |

**索引**:
- `idx_users_email` - email（唯一索引）

---

### ${TABLE_2}

| 字段 | 类型 | 约束 | 描述 |
|------|------|------|------|
| ${FIELD_1} | ${TYPE_1} | ${CONSTRAINT_1} | ${DESC_1} |

**外键**:
- `${FK_NAME}` - ${FK_FIELD} → ${FK_REF}

---

## 迁移记录

| 版本 | 日期 | 描述 |
|------|------|------|
| V1 | ${DATE_1} | 初始化数据库 |
| V2 | ${DATE_2} | ${MIGRATION_DESC_2} |
```

### 5.5 ADR 模板

```markdown
# ADR-${ADR_NUMBER}: ${ADR_TITLE}

**日期**: ${CURRENT_DATE}
**状态**: 已接受 / 已拒绝 / 已废弃
**作者**: ${AUTHOR}

## 背景

${CONTEXT_DESCRIPTION}

## 决策

${DECISION_DESCRIPTION}

## 理由

${RATIONALE}

## 后果

**正面后果**：
- ${POSITIVE_1}
- ${POSITIVE_2}

**负面后果**：
- ${NEGATIVE_1}

## 替代方案

### 方案 1: ${ALT_1_NAME}
- **优点**: ${ALT_1_PROS}
- **缺点**: ${ALT_1_CONS}
- **未采用原因**: ${ALT_1_REASON}
```

---

## 6. 初始化协议

> **核心**：Claude Code 读取此协议后，与用户对话确认需求，然后自动完成初始化

### 6.1 初始化流程

```
┌─────────────────────────────────────────────────────────────┐
│                    初始化协议流程                            │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  Step 1: 读取本指南                                          │
│     ↓                                                       │
│  Step 2: 与用户确认项目信息（使用确认清单）                    │
│     ↓                                                       │
│  Step 3: 根据技术栈配置表，确定变量值                         │
│     ↓                                                       │
│  Step 4: 创建目录结构                                        │
│     ↓                                                       │
│  Step 5: 生成文档（替换模板变量）                             │
│     ↓                                                       │
│  Step 6: 创建 Slash Commands（复制完整配置）                  │
│     ↓                                                       │
│  Step 7: 初始化 Git（如果需要）                               │
│     ↓                                                       │
│  Step 8: 输出初始化报告                                      │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 6.2 确认清单（Claude Code 必须与用户确认）

#### 6.2.1 项目基本信息

```
□ 项目名称: _______________
□ 项目类型: [ ] 个人网站  [ ] Web 应用  [ ] API 服务  [ ] 全栈应用  [ ] 其他: ___
□ 项目描述（一句话）: _______________
```

#### 6.2.2 技术栈选择

```
□ 包管理器: [ ] npm  [ ] yarn  [ ] pnpm  [ ] bun
  └─ 默认推荐: pnpm

□ 前端框架: [ ] React + Vite  [ ] Vue + Vite  [ ] Next.js  [ ] Nuxt  [ ] 无前端
  └─ 语言: [ ] JavaScript  [ ] TypeScript
  └─ 默认推荐: React + Vite + JavaScript

□ 后端框架: [ ] Spring Boot  [ ] FastAPI  [ ] Express  [ ] NestJS  [ ] 无后端
  └─ 默认推荐:
     - 一般项目: Spring Boot
     - AI 相关项目: FastAPI

□ 数据库: [ ] MySQL  [ ] PostgreSQL  [ ] MongoDB  [ ] SQLite  [ ] 无数据库
  └─ 默认推荐: PostgreSQL

□ 部署平台: [ ] Vercel  [ ] Netlify  [ ] Docker  [ ] AWS  [ ] 其他: ___
```

#### 6.2.3 Monorepo 结构

```
□ 应用结构:
  apps/
  ├── frontend/    [ ] 需要  [ ] 不需要
  ├── backend/     [ ] 需要  [ ] 不需要
  └── admin/       [ ] 需要  [ ] 不需要（管理后台）

□ 共享包:
  packages/
  ├── shared/      [ ] 需要  [ ] 不需要（共享工具/类型）
  └── ui/          [ ] 需要  [ ] 不需要（共享组件库）
```

#### 6.2.4 其他配置

```
□ 是否已有 Git 仓库: [ ] 是  [ ] 否（需要初始化）
□ 是否需要 CI/CD 配置: [ ] 是  [ ] 否
□ 代码规范: [ ] ESLint + Prettier  [ ] 仅 ESLint  [ ] 无
```

### 6.3 初始化命令序列

> Claude Code 在确认完成后执行以下命令

#### Step 4: 创建目录结构

```bash
# 获取当前时间
CURRENT_DATE=$(date +%Y-%m-%d)
CURRENT_TIME=$(date +%H:%M)
WEEK_NUM=$(date +%V)

# 创建文档目录
mkdir -p docs/ai-context/archive
mkdir -p docs/development/frontend
mkdir -p docs/development/backend
mkdir -p docs/architecture/adr
mkdir -p docs/project
mkdir -p docs/guides
mkdir -p docs/reports

# 创建 Slash Commands 目录
mkdir -p .claude/commands

# 创建应用目录（根据确认结果）
mkdir -p apps/frontend
mkdir -p apps/backend
# mkdir -p packages/shared  # 如果需要
```

#### Step 5: 生成文档

Claude Code 使用模板（第 5 节）生成以下文件：
- `docs/ai-context/CONTEXT.md`
- `docs/ai-context/CURRENT.md`
- `docs/development/DEVELOPMENT.md`
- `docs/development/frontend/components.md`
- `docs/development/frontend/pages.md`
- `docs/development/frontend/troubleshooting.md`
- `docs/development/backend/api.md`
- `docs/development/backend/database.md`
- `docs/development/backend/troubleshooting.md`
- `docs/architecture/OVERVIEW.md`
- `docs/architecture/tech-stack.md`
- `docs/architecture/adr/README.md`
- `docs/architecture/adr/template.md`
- `docs/project/vision.md`
- `docs/project/design.md`
- `docs/project/ROADMAP.md`

#### Step 6: 创建 Slash Commands

从 `02-Slash-Commands完整配置.md` 复制以下文件：
- `.claude/commands/start.md`
- `.claude/commands/checkpoint.md`
- `.claude/commands/end.md`
- `.claude/commands/weekly.md`
- `.claude/commands/monthly.md`
- `.claude/commands/audit.md`

#### Step 7: Git 初始化（如果需要）

```bash
# 初始化 Git（如果没有）
git init

# 创建 .gitignore
cat > .gitignore << 'EOF'
# Dependencies
node_modules/
__pycache__/
*.pyc
.venv/
venv/

# Build
dist/
build/
.next/
.nuxt/
target/

# IDE
.idea/
.vscode/
*.swp

# OS
.DS_Store
Thumbs.db

# Environment
.env
.env.local
.env.*.local

# Logs
*.log
npm-debug.log*

# Lock files (根据包管理器保留对应的)
# package-lock.json
# yarn.lock
# pnpm-lock.yaml
# bun.lockb
EOF

# 首次 commit
git add .
git commit -m "$(cat <<'EOF'
chore: 初始化项目 + AI 协作系统

- 创建 Monorepo 目录结构
- 配置 4 层文档架构
- 配置 6 个 Slash Commands
- 建立 AI 记忆恢复机制

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"
```

### 6.4 初始化报告模板

```markdown
## ✅ 项目初始化完成

### 项目信息
- **项目名称**: ${PROJECT_NAME}
- **技术栈**: ${FE_FRAMEWORK} + ${BE_FRAMEWORK} + ${DB_TYPE}
- **包管理器**: ${PM}

### 已创建目录
```
${CREATED_DIRECTORIES}
```

### 已创建文件
- 文档文件: ${DOC_COUNT} 个
- Slash Commands: 6 个

### 下一步
1. 执行 `/start --full` 让我完整恢复上下文
2. 告诉我你想先开发什么功能
3. 我们开始开发！

### 常用命令
- `/start` - 恢复项目记忆
- `/checkpoint` - 阶段性保存进度
- `/end --push` - 每日结束

---
**初始化时间**: ${CURRENT_DATE} ${CURRENT_TIME}
```

---

## 7. Slash Commands 概述

> 详细配置见 `02-Slash-Commands完整配置.md`

### 7.1 命令总览

| 命令 | 用途 | 使用频率 | 参数 |
|------|------|----------|------|
| `/start` | 恢复项目记忆 | 每次会话开始 | `--full`, `--bug`, `--api` |
| `/checkpoint` | 阶段性保存进度 | 完成一个功能后 | `--commit`, `--skip-git` |
| `/end` | 每日结束 | 每天结束时 | `--push`, `--no-push` |
| `/weekly` | 每周文档优化 | 每周日 | `--push` |
| `/monthly` | 每月归档 | 每月初 | `--push` |
| `/audit` | 项目健康检查 | 每周/每月 | `--quick`, `--full`, `--security` |

### 7.2 使用流程

```
每日开发流程:

┌─────────────────┐
│ 会话开始        │ → /start
└────────┬────────┘
         ↓
┌─────────────────┐
│ 开发功能 A      │
└────────┬────────┘
         ↓
┌─────────────────┐
│ 功能完成        │ → /checkpoint --commit
└────────┬────────┘
         ↓
┌─────────────────┐
│ 开发功能 B      │
└────────┬────────┘
         ↓
┌─────────────────┐
│ 每日结束        │ → /end --push
└─────────────────┘

每周维护:
- 周日: /weekly --push

每月维护:
- 月初: /monthly --push
```

---

## 8. Git 工作流

### 8.1 Commit Message 规范

```
<type>(<scope>): <subject>

<body>

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
```

**Type 类型**:
| Type | 描述 | 示例 |
|------|------|------|
| `feat` | 新功能 | feat(auth): 添加用户登录 |
| `fix` | Bug 修复 | fix(api): 修复空指针异常 |
| `docs` | 文档更新 | docs: 更新 API 文档 |
| `refactor` | 重构 | refactor(utils): 优化日期处理 |
| `perf` | 性能优化 | perf(query): 优化数据库查询 |
| `test` | 测试 | test(auth): 添加登录测试 |
| `chore` | 构建/工具 | chore: 更新依赖 |

### 8.2 使用 HEREDOC 创建 Commit

```bash
git commit -m "$(cat <<'EOF'
feat(blog): 添加博客列表页面

- 实现文章列表组件
- 添加分页功能
- 集成 API 数据获取

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"
```

---

## 9. 最佳实践

### 9.1 文档维护

| DO ✅ | DON'T ❌ |
|-------|----------|
| 每次会话开始执行 `/start` | 跳过 `/start` 直接开发 |
| 每次结束执行 `/end` | 不更新文档就离开 |
| 每周执行 `/weekly` | 让 CURRENT.md 膨胀 |
| Bug 修复后创建 troubleshooting | 忘记记录问题解决方案 |
| 重大决策创建 ADR | 只在脑子里记住决策 |

### 9.2 AI 协作

| DO ✅ | DON'T ❌ |
|-------|----------|
| 首次使用 `/start --full` | 首次使用只用 `/start` |
| 每 2-3 小时一个 `/checkpoint` | 一次会话做太多不记录 |
| 根据任务选择场景参数 | 每次都用默认参数 |

### 9.3 Token 优化

| 目标 | Token 预算 |
|------|------------|
| CONTEXT.md | < 3000 tokens |
| CURRENT.md | < 2500 tokens |
| 单次 `/start` 总读取 | < 5500 tokens |

---

## 10. FAQ

### Q1: 为什么要分离 AI 文档和开发者文档？

**A**: AI 文档追求简洁（~3000 tokens），开发者文档追求详细。混在一起会导致 AI 每次恢复上下文读取大量无关内容，Token 浪费。

### Q2: 多久需要归档一次 CURRENT.md？

**A**: 每月归档一次（通过 `/monthly` 命令）。如果 Token 超过 2500，可以提前归档。

### Q3: 后端用 Spring Boot 还是 FastAPI？

**A**:
- 一般 Web 应用 → Spring Boot（生态成熟）
- AI/ML 相关项目 → FastAPI（Python 生态，与 AI 库集成好）

### Q4: 如何选择数据库？

**A**:
- 一般项目 → PostgreSQL（功能全面，性能好）
- 简单项目 → MySQL（易上手）
- 需要灵活 Schema → MongoDB

### Q5: 如果 AI 理解项目有误怎么办？

**A**:
1. 检查 CONTEXT.md 是否准确
2. 检查 vision.md 是否详细描述了设计风格
3. 重新执行 `/start --full`

---

## 附录

### 附录 A: 时间工具命令

```bash
# 基础时间
CURRENT_DATE=$(date +%Y-%m-%d)          # 2025-11-23
CURRENT_TIME=$(date +%H:%M)             # 14:30
CURRENT_DATETIME="$CURRENT_DATE $CURRENT_TIME"

# 星期相关
CURRENT_DAY_OF_WEEK=$(date +%u)         # 1-7
CURRENT_WEEK_NUM=$(date +%V)            # 47

# 星期中文
case $(date +%u) in
    1) DAY_NAME="周一" ;; 2) DAY_NAME="周二" ;;
    3) DAY_NAME="周三" ;; 4) DAY_NAME="周四" ;;
    5) DAY_NAME="周五" ;; 6) DAY_NAME="周六" ;;
    7) DAY_NAME="周日" ;;
esac

# 周起止日期（macOS）
WEEK_START=$(date -v-$(( $(date +%u) - 1 ))d +%Y-%m-%d)
WEEK_END=$(date -v+$(( 7 - $(date +%u) ))d +%Y-%m-%d)
```

### 附录 B: 完整目录结构示例

```
your-project/
├── .claude/
│   └── commands/
│       ├── start.md
│       ├── checkpoint.md
│       ├── end.md
│       ├── weekly.md
│       ├── monthly.md
│       └── audit.md
│
├── docs/
│   ├── ai-context/
│   │   ├── CONTEXT.md
│   │   ├── CURRENT.md
│   │   └── archive/
│   ├── development/
│   │   ├── frontend/
│   │   │   ├── components.md
│   │   │   ├── pages.md
│   │   │   └── troubleshooting.md
│   │   ├── backend/
│   │   │   ├── api.md
│   │   │   ├── database.md
│   │   │   └── troubleshooting.md
│   │   ├── DEVELOPMENT.md
│   │   └── SLASH_COMMANDS.md
│   ├── architecture/
│   │   ├── OVERVIEW.md
│   │   ├── tech-stack.md
│   │   └── adr/
│   │       ├── README.md
│   │       └── template.md
│   ├── project/
│   │   ├── vision.md
│   │   ├── design.md
│   │   ├── ROADMAP.md
│   │   └── DEPLOYMENT.md
│   └── guides/
│       ├── 01-AI协作系统配置指南.md
│       ├── 02-Slash-Commands完整配置.md
│       └── 03-系统健康排查指南.md
│
├── apps/
│   ├── frontend/
│   │   ├── src/
│   │   ├── package.json
│   │   └── vite.config.js
│   └── backend/
│       ├── src/
│       └── pom.xml / requirements.txt
│
├── packages/
│   └── shared/
│
├── README.md
├── package.json
└── .gitignore
```

---

**版本**: v2.0
**更新日期**: 2025-11-26
