# 工程量计算 - 技术调研

> 工程量计算的技术实现方案调研

---

## 核心问题

| 问题 | 说明 | 状态 |
|------|------|------|
| 计算在哪执行？ | Revit 插件端 vs 系统服务器端 | 待确认 |
| 规则如何配置？ | 系统端配置界面/方式 | 待确认 |
| 规则如何传递？ | Revit 如何识别/解码配置的规则 | 待确认 |
| 引擎如何调用？ | Revit API 的具体使用方式 | 待确认 |

---

## 李昱给出的方向

```
计算流程:
  1. 系统配置计算规则
  2. Revit 解码规则
  3. 调用 Revit API 底层计算引擎
  4. 输出工程量

原则：不要写死，功能解耦
```

---

## 复杂案例

### 幕墙工程量

**问题**：幕墙的工程量计算涉及跨构件运算

```
幕墙工程量 = 幕墙面积 - 嵌板面积
```

**待解决**：

- [ ] 跨构件关联：如何识别幕墙与其嵌板的从属关系？
- [ ] 自动计算：如何实现自动的减法运算？
- [ ] 数据结构：是否需要特殊的数据结构来支持这种关联？

**可能方案**：

- 方案A：Revit 插件导出时带出关联信息
- 方案B：系统层面建立父子构件关系
- 方案C：易达定制开发特殊出量逻辑

---

## 待调研事项

- [ ] 试用系统端计算功能（黄增沛说已可用）
- [ ] 了解现有计算规则的配置方式
- [ ] 梳理需要支持的清单类型和计算规则
- [ ] 确认 Revit API 计算引擎的能力边界

---

## 参考

- [01-原型评审/03_工程量计算.md](../../01-原型评审/03_工程量计算.md)
- [issues/open/99_待讨论问题.md](../../issues/open/99_待讨论问题.md)

---

**最后更新**: 2025-12-02
