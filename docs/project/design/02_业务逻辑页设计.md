# 业务逻辑页设计

> 清单匹配规则与典型案例展示

**最后更新**: 2025-12-10

---

## 一、页面目标

| 目标 | 说明 |
|-----|------|
| **理解匹配规则** | 5 种清单匹配方式 |
| **学习案例** | 3 个典型应用场景 |
| **快速查阅** | 可展开的详情卡片 |

---

## 二、页面结构

```
业务逻辑页 (/logic)
├── Page Header
│   ├── 标题：业务逻辑
│   └── 描述：清单匹配规则与典型案例
│
├── Match Rules Section（匹配规则）
│   └── 5 张规则卡片（响应式网格）
│       ├── 无条件匹配
│       ├── 单参数区间
│       ├── 单参数精确
│       ├── 多参数 AND
│       └── 多参数区间联合
│
└── Use Cases Section（典型案例）
    └── 3 个可展开案例卡片
        ├── 新风机
        ├── MCD-新风机
        └── 楼板
```

---

## 三、匹配规则区块

### 3.1 布局

2x2 网格布局（sm:grid-cols-2）

### 3.2 卡片设计

```
┌──────────────────────────────────────┐
│  ┌────┐                              │
│  │ ✓ │  无条件匹配                   │
│  └────┘  (渐变图标)                  │
│                                      │
│  所有族实例都带出该清单              │
│                                      │
│  [排风扇 → 电源清单]                 │
│  (示例代码标签)                      │
└──────────────────────────────────────┘
```

### 3.3 四种规则

| 规则 | 图标 | 渐变色 | 描述 | 示例 |
|-----|------|--------|------|------|
| 无条件匹配 | 对勾 | emerald→teal | 所有族实例都带出该清单 | 排风扇 → 电源清单 |
| 精确值匹配 | 圆圈对勾 | blue→indigo | 参数值完全相等时匹配 | 风量 = 3000 |
| 区间匹配 | 双箭头 | amber→orange | 参数值在指定范围内匹配 | 2000 ≤ 风量 < 4000 |
| 多参数 AND | 网格+ | purple→pink | 多个条件同时满足才匹配 | 材质=灰砖 AND 品牌=琛雄 |

### 3.4 数据结构

```javascript
const matchTypes = [
  {
    id: 'unconditional',
    name: '无条件匹配',
    desc: '所有族实例都带出该清单',
    example: '排风扇 → 电源清单',
    gradient: 'from-emerald-500 to-teal-500',
    icon: <CheckIcon />,
  },
  {
    id: 'exact',
    name: '精确值匹配',
    desc: '参数值完全相等时匹配',
    example: '风量 = 3000',
    gradient: 'from-blue-500 to-indigo-500',
    icon: <CheckCircleIcon />,
  },
  {
    id: 'range',
    name: '区间匹配',
    desc: '参数值在指定范围内匹配',
    example: '2000 ≤ 风量 < 4000',
    gradient: 'from-amber-500 to-orange-500',
    icon: <ArrowsIcon />,
  },
  {
    id: 'multi',
    name: '多参数 AND',
    desc: '多个条件同时满足才匹配',
    example: '材质=灰砖 AND 品牌=琛雄',
    gradient: 'from-purple-500 to-pink-500',
    icon: <GridPlusIcon />,
  },
]
```

---

## 四、典型案例区块

### 4.1 布局

垂直堆叠的可展开卡片（space-y-4）

### 4.2 卡片收起状态

```
┌──────────────────────────────────────────────────────────────┐
│  ┌────┐  新风机                                         ▼   │
│  │ 新 │  (渐变首字母)     [自建族] [精确值匹配] [计数]      │
│  └────┘                                                      │
│  最简单场景：一个品目、多个类型、精确匹配                    │
└──────────────────────────────────────────────────────────────┘
```

### 4.3 卡片展开状态

```
┌──────────────────────────────────────────────────────────────┐
│  ┌────┐  新风机                                         ▲   │
│  │ 新 │  (渐变首字母)     [自建族] [精确值匹配] [计数]      │
│  └────┘                                                      │
│  最简单场景：一个品目、多个类型、精确匹配                    │
├──────────────────────────────────────────────────────────────┤
│                                                              │
│  构件属性                        清单匹配                    │
│  ┌──────────────────┐           ┌──────────────────────────┐ │
│  │ 风量（M³/H）     │           │ 新风机3000M³/H           │ │
│  └──────────────────┘           │ 风量 = 3000              │ │
│                                 ├──────────────────────────┤ │
│  品目类型                       │ 新风机5000M³/H           │ │
│  • 3000M³/H                     │ 风量 = 5000              │ │
│  • 5000M³/H                     ├──────────────────────────┤ │
│  • 7000M³/H                     │ 新风机7000M³/H           │ │
│                                 │ 风量 = 7000              │ │
│                                 └──────────────────────────┘ │
└──────────────────────────────────────────────────────────────┘
```

### 4.4 三个案例

| 案例 | 族类型 | 匹配方式 | 出量方式 | 渐变色 |
|-----|--------|---------|---------|--------|
| 新风机 | 自建族 | 精确值匹配 | 计数（台） | blue→cyan |
| MCD-新风机 | 自建族 | 区间匹配 | 计数（台） | amber→orange |
| 楼板 | 系统族 | 多参数 AND | 面积汇总（m²） | purple→pink |

### 4.5 数据结构

```javascript
const cases = [
  {
    id: 'fresh-air-fan',
    name: '新风机',
    type: '自建族',
    match: '精确值匹配',
    quantity: '计数（台）',
    gradient: 'from-blue-500 to-cyan-500',
    desc: '最简单场景：一个品目、多个类型、精确匹配',
    detail: {
      param: '风量（M³/H）',
      types: ['3000M³/H', '5000M³/H', '7000M³/H'],
      bills: [
        { name: '新风机3000M³/H', condition: '风量 = 3000' },
        { name: '新风机5000M³/H', condition: '风量 = 5000' },
        { name: '新风机7000M³/H', condition: '风量 = 7000' },
      ],
    },
  },
  {
    id: 'mcd-fan',
    name: 'MCD-新风机',
    type: '自建族',
    match: '区间匹配',
    quantity: '计数（台）',
    gradient: 'from-amber-500 to-orange-500',
    desc: '展示区间匹配：参数区间判断、一对多清单',
    detail: {
      param: '风量（实例参数）',
      types: ['默认（只需一个）'],
      bills: [
        { name: '供应...4000CMH及以上', condition: '风量 ≥ 4000' },
        { name: '供应...2000-4000CMH', condition: '2000 ≤ 风量 < 4000' },
        { name: '供应...2000CMH及以下', condition: '风量 < 2000' },
        { name: '电源', condition: '无条件' },
      ],
    },
  },
  {
    id: 'floor-slab',
    name: '楼板',
    type: '系统族',
    match: '多参数 AND',
    quantity: '面积汇总（m²）',
    gradient: 'from-purple-500 to-pink-500',
    desc: '展示多参数 AND 匹配：材质 + 品牌',
    detail: {
      param: '结构材质 + 品牌',
      types: ['MCD-厨房灰色砖'],
      bills: [
        { name: '灰色砖地面（琛雄）', condition: '材质=厨房灰色砖 AND 品牌=琛雄' },
        { name: '灰色砖地面（共荣）', condition: '材质=厨房灰色砖 AND 品牌=共荣' },
        { name: '灰色砖地面（冠军）', condition: '材质=厨房灰色砖 AND 品牌=冠军' },
      ],
    },
  },
]
```

---

## 五、交互设计

### 5.1 展开/收起

```jsx
const [expandedCase, setExpandedCase] = useState(null)

<button onClick={() => setExpandedCase(expandedCase === c.id ? null : c.id)}>
  ...
</button>

<div className={`overflow-hidden transition-all duration-300 ${
  expandedCase === c.id ? 'max-h-[500px]' : 'max-h-0'
}`}>
  {/* 详情内容 */}
</div>
```

### 5.2 动画效果

- 卡片: hover:border-primary/50
- 展开箭头: rotate-180 过渡
- 详情区域: max-h 过渡动画
- 滚动入场: animate-on-scroll

---

## 六、响应式设计

| 断点 | 规则卡片 | 案例详情 |
|-----|---------|---------|
| 手机 | 1列 | 垂直堆叠 |
| 平板+ | 2列 | 左右两栏 |

---

## 变更记录

| 版本 | 日期 | 修改内容 |
|------|------|----------|
| v1.0 | 2025-11-27 | 新建，合并原业务流程页和场景案例页 |
